{
  "$schema": "http://json-schema.org/draft-07/schema",
  "description": "Schema definitions used for Datasworn and Dataforged (v2+).",
  "definitions": {
    "AttributeID": {
      "type": "string",
      "pattern": "^[a-z_]+/(assets/[a-z_]+/[a-z_]+(/moves/[a-z_]+)?|moves/[a-z_]+/[a-z_]+)/attributes/[a-z_]+$"
    },
    "AttributeSetter": {
      "propertyNames": {
        "$ref": "#/definitions/AttributeID"
      },
      "patternProperties": {
        "^.*$": {
          "$ref": "#/definitions/PlayerStatID"
        }
      }
    },
    "AttributeNumericType": {
      "type": "string",
      "enum": [
        "condition_meter",
        "clock",
        "counter"
      ]
    },
    "AttributeCounter": {
      "allOf": [
        {
          "$ref": "#definitions/AttributeNumericBase"
        },
        {
          "properties": {
            "attribute_type": {
              "const": "counter"
            },
            "min": {
              "type": "integer",
              "default": 0
            },
            "max": {
              "type": [
                "null",
                "integer"
              ],
              "default": null
            },
            "value": {
              "type": "integer",
              "default": 0
            }
          }
        }
      ]
    },
    "AttributeNumericBase": {
      "description": "Schema from which other numeric attributes are derived. Shouldn't be used directly.",
      "type": "object",
      "allOf": [
        {
          "$ref": "#/definitions/AttributeBase"
        },
        {
          "required": [
            "min",
            "max",
            "value",
            "attribute_type"
          ],
          "properties": {
            "attribute_type": {
              "$ref": "#/definitions/AttributeNumericType"
            },
            "min": {
              "type": "integer"
            },
            "max": {
              "type": [
                "integer",
                "null"
              ]
            },
            "value": {
              "type": [
                "integer",
                "null"
              ]
            }
          }
        }
      ]
    },
    "AttributeNumericOverride": {
      "description": "Adjusts an existing numeric input, usually a condition meter",
      "type": "object",
      "additionalProperties": false,
      "required": [
        "_extends"
      ],
      "properties": {
        "_extends": {
          "$ref": "#/definitions/AttributeID"
        },
        "min": {
          "type": "integer"
        },
        "max": {
          "type": "integer"
        },
        "value": {
          "type": "integer"
        }
      }
    },
    "AttributeImpact": {
      "allOf": [
        {
          "$ref": "#/definitions/AttributeBase"
        },
        {
          "required": [
            "attribute_type"
          ],
          "properties": {
            "attribute_type": {
              "const": "impact"
            }
          }
        }
      ]
    },
    "AttributeBase": {
      "type": "object",
      "required": [
        "attribute_type",
        "position",
        "label"
      ],
      "properties": {
        "_id": {
          "$ref": "#/definitions/AttributeID"
        },
        "label": {
          "$ref": "#/definitions/LocalizedLabel"
        },
        "position": {
          "$ref": "#/definitions/InputPosition"
        },
        "attribute_type": {
          "oneOf": [
            {
              "$ref": "#/definitions/AttributeNumericType"
            },
            {
              "type": "string",
              "enum": [
                "player_stat",
                "player_condition_meter",
                "impact",
                "text"
              ]
            }
          ]
        }
      }
    },
    "PlayerConditionMeterName": {
      "enum": [
        "health",
        "spirit",
        "supply"
      ]
    },
    "AttributeClock": {
      "allOf": [
        {
          "$ref": "#/definitions/AttributeNumericBase"
        },
        {
          "required": [
            "attribute_type",
            "min",
            "value",
            "max"
          ],
          "properties": {
            "attribute_type": {
              "const": "clock"
            },
            "min": {
              "const": 0
            },
            "value": {
              "default": 0
            },
            "max": {
              "title": "ClockSegments",
              "type": "integer",
              "multipleOf": 2,
              "minimum": 4,
              "maximum": 10
            }
          }
        }
      ]
    },
    "AttributeConditionMeter": {
      "allOf": [
        {
          "$ref": "#/definitions/AttributeNumericBase"
        },
        {
          "required": [
            "label",
            "position",
            "attribute_type",
            "min",
            "value",
            "max"
          ],
          "properties": {
            "label": {
              "$ref": "#/definitions/LocalizedLabel"
            },
            "position": {
              "const": "card-bottom"
            },
            "attribute_type": {
              "const": "condition_meter"
            },
            "value": {
              "type": "integer"
            },
            "max": {
              "type": "integer"
            },
            "min": {
              "const": 0
            }
          }
        }
      ]
    },
    "AttributePlayerConditionMeter": {
      "description": "A select element with predefined options to pick a standard player character condition meter.",
      "allOf": [
        {
          "$ref": "#/definitions/AttributeBase"
        },
        {
          "required": [
            "attribute_type",
            "value",
            "options",
            "position"
          ],
          "properties": {
            "attribute_type": {
              "const": "player_condition_meter"
            },
            "position": {
              "default": "card-top"
            },
            "value": {
              "description": "The current value of this attribute. In Dataforged/Datasworn's data, this will almost always be `null`, but other values are provided to ensure that types generated from the schema can be used at run-time or for static typing.",
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/definitions/PlayerConditionMeterID"
                }
              ],
              "default": null
            },
            "options": {
              "type": "object",
              "patternProperties": {
                "^[a-z][a-z_+]*[a-z]$": {
                  "type": "object",
                  "properties": {
                    "label": {
                      "$ref": "#/definitions/LocalizedLabel"
                    },
                    "value": {
                      "$ref": "#/definitions/PlayerConditionMeterID"
                    }
                  }
                }
              }
            }
          }
        }
      ]
    },
    "AttributeText": {
      "description": "A text attribute that accepts a user-provided string value. Recommended HTML element: <input type='text'>",
      "allOf": [
        {
          "$ref": "#/definitions/AttributeBase"
        },
        {
          "required": [
            "attribute_type",
            "position",
            "value"
          ],
          "properties": {
            "attribute_type": {
              "const": "text"
            },
            "position": {
              "default": "card-top"
            },
            "value": {
              "type": [
                "null",
                "string"
              ],
              "default": null
            }
          }
        }
      ]
    },
    "AttributePlayerStat": {
      "description": "An attribute with predefined options to pick a standard player character stat. Recommended HTML element: <select>",
      "allOf": [
        {
          "$ref": "#/definitions/AttributeBase"
        },
        {
          "required": [
            "attribute_type",
            "position",
            "value",
            "options"
          ],
          "properties": {
            "attribute_type": {
              "const": "player_stat"
            },
            "position": {
              "default": "card-top"
            },
            "value": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/definitions/PlayerStatID"
                }
              ],
              "default": null
            },
            "options": {
              "type": "object",
              "patternProperties": {
                "^[a-z][a-z_+]*[a-z]$": {
                  "type": "object",
                  "properties": {
                    "label": {
                      "$ref": "#/definitions/LocalizedLabel"
                    },
                    "value": {
                      "$ref": "#/definitions/PlayerStatID"
                    }
                  }
                }
              }
            }
          }
        }
      ]
    },
    "MoveTrigger": {
      "title": "MoveTrigger",
      "type": "object",
      "properties": {
        "options": {
          "type": "array",
          "oneOf": [
            {
              "items": {
                "$ref": "#/definitions/MoveTriggerOptionAction"
              }
            },
            {
              "items": {
                "$ref": "#/definitions/MoveTriggerOptionProgress"
              }
            }
          ]
        },
        "text": {
          "description": "A markdown string containing the primary trigger text for this move.\n\nSecondary triggers (for specific stats or uses of an asset ability) are described in `Options`.",
          "type": "string"
        },
        "by": {
          "description": "Information on who can trigger this item. Usually this is just the player, but some asset abilities can trigger from an Ally's move.",
          "additionalProperties": false,
          "properties": {
            "player": {
              "type": "boolean",
              "default": "true"
            },
            "ally": {
              "type": "boolean",
              "default": "false"
            }
          }
        }
      },
      "additionalProperties": false
    },
    "PlayerStatName": {
      "enum": [
        "edge",
        "heart",
        "iron",
        "shadow",
        "wits"
      ]
    },
    "ImpactID": {
      "type": "string",
      "pattern": "^[a-z][a-z_+]*[a-z]/impacts/[a-z][a-z_+]*[a-z]/[a-z][a-z_+]*[a-z]$"
    },
    "PlayerCharacter": {
      "properties": {
        "stats": {
          "type": "object",
          "propertyNames": {
            "$ref": "#/definitions/PlayerStatName"
          },
          "patternProperties": {
            ".*": {
              "type": "object",
              "properties": {
                "_id": {
                  "$ref": "#/definitions/PlayerStatID"
                },
                "max": {
                  "const": 4
                },
                "min": {
                  "const": 0
                },
                "value": {
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 4
                }
              }
            }
          }
        },
        "condition_meters": {
          "type": "object",
          "patternProperties": {
            "^[a-z][a-z_+]*[a-z]$": {
              "$ref": "#/definitions/AttributeConditionMeter"
            }
          }
        },
        "momentum": {
          "type": "object",
          "properties": {
            "min": {
              "type": "integer",
              "const": -6
            },
            "max": {
              "type": "integer",
              "default": 10,
              "maximum": 10
            },
            "value": {
              "type": "integer",
              "default": 2
            },
            "resetValue": {
              "type": "integer",
              "default": 2,
              "min": 0
            }
          }
        }
      }
    },
    "ProgressTrackType": {
      "$ref": "#/definitions/SnakeCase",
      "enum": [
        "discoveries_legacy",
        "combat",
        "expedition",
        "journey",
        "bond",
        "connection",
        "delve"
      ]
    },
    "SnakeCase": {
      "type": "string",
      "pattern": "^[a-z][a-z_0-9]*[a-z0-9]$",
      "description": "A plain text string in snake_case. Usually this is an internal value for programmatic use only, so it shouldn't be localized."
    },
    "PlayerStatID": {
      "description": "A standard player character stat.",
      "enum": [
        "player/stats/edge",
        "player/stats/heart",
        "player/stats/iron",
        "player/stats/shadow",
        "player/stats/wits"
      ]
    },
    "PlayerConditionMeterID": {
      "description": "A standard player character condition meter.",
      "enum": [
        "player/condition_meters/health",
        "player/condition_meters/spirit",
        "player/condition_meters/supply"
      ]
    },
    "ConditionMeterAlias": {
      "$ref": "#/definitions/SnakeCase",
      "description": "Names of non-player condition meters (for e.g. companions and vehicles) that are referenced by moves and other assets.\nIf an asset condition meter can be used in this manner, the alias is included in its Aliases array.",
      "enum": [
        "companion_health",
        "vehicle_integrity",
        "command_vehicle_integrity",
        "support_vehicle_integrity",
        "incidental_vehicle_integrity",
        "attached_asset_meter"
      ]
    },
    "ConditionMeterType": {
      "oneOf": [
        {
          "$ref": "#/definitions/PlayerConditionMeterID"
        },
        {
          "$ref": "#/definitions/ConditionMeterAlias"
        }
      ]
    },
    "GameObject": {
      "description": "Describes a game object, with optional required parameters (for example, a specific Location result).",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": {
          "title": "GameObjectType",
          "$ref": "#/definitions/SnakeCase",
          "enum": [
            "character",
            "creature",
            "derelict",
            "derelict_zone",
            "faction",
            "planet",
            "precursor_vault",
            "settlement",
            "starship"
          ]
        }
      }
    },
    "ChallengeRank": {
      "type": "integer",
      "description": "A numeric challenge rank: 1 = troublesome; 2 = dangerous; 3 = formidable; 4 = extreme; 5 = epic.",
      "enum": [
        1,
        2,
        3,
        4,
        5
      ]
    },
    "AssetAbilityID": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9_]*[a-z0-9]/assets(/[a-z][a-z_]*[a-z]){2}/abilities/[0-2]$"
    },
    "AssetAbility": {
      "title": "AssetAbility",
      "description": "Describes an asset ability.",
      "allOf": [
        {
          "$ref": "#/definitions/AssetAbilityBase"
        },
        {
          "required": [
            "text"
          ],
          "properties": {
            "alter_moves": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/AlterMove"
              }
            },
            "extend_abilities": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ExtendAssetAbility"
              }
            },
            "text": {
              "$ref": "#/definitions/AssetAbilityBase/properties/text"
            }
          }
        }
      ]
    },
    "AssetAbilityBase": {
      "type": "object",
      "properties": {
        "name": {
          "description": "Ironsworn companion assets provide names for their abilities. Starforged asset abilities do not have names.",
          "$ref": "#/definitions/LocalizedLabel"
        },
        "text": {
          "description": "The rules text for this asset ability.",
          "$ref": "#/definitions/LocalizedMarkdown"
        },
        "attachments": {
          "description": "Details on what attachments (other assets) are accepted by this asset.",
          "$comment": "#/definitions/AssetAttachment ... consider rewriting as an attribute? Could attachments be managed with e.g. a regex?"
        },
        "attributes": {
          "patternProperties": {
            "^[a-z][a-z_+]*[a-z]$": {
              "oneOf": [
                {
                  "$ref": "#/definitions/AttributeNumericOverride"
                },
                {
                  "$comment": "New condition meters require an ID.",
                  "allOf": [
                    {
                      "oneOf": [
                        {
                          "$ref": "#/definitions/AttributeConditionMeter"
                        },
                        {
                          "$ref": "#/definitions/AttributeCounter"
                        },
                        {
                          "$ref": "#/definitions/AttributeText"
                        },
                        {
                          "$ref": "#/definitions/AttributeClock"
                        }
                      ]
                    },
                    {
                      "required": [
                        "_id"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        "moves": {
          "description": "Unique, self-contained moves added by this asset ability.",
          "type": "object",
          "patternProperties": {
            "^[a-z][a-z_+]*[a-z]$": {
              "$ref": "#/definitions/Move"
            }
          }
        },
        "alter_moves": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/AlterMoveBase"
          }
        },
        "alter_player": {
          "$ref": "#/definitions/AlterPlayer"
        },
        "_id": {
          "$ref": "#/definitions/AssetAbilityID"
        },
        "enabled": {
          "description": "Whether the asset ability is enabled or not. In most cases, the first asset ability defaults to 'true' and the others to 'false'. If none of an asset's abilities are set to 'true', the player can pick which the ability they start with when purchasing the asset.",
          "type": "boolean",
          "default": false
        }
      }
    },
    "Attribute": {
      "oneOf": [
        {
          "$ref": "#/definitions/AttributePlayerStat"
        },
        {
          "$ref": "#/definitions/AttributePlayerConditionMeter"
        },
        {
          "$ref": "#/definitions/AttributeText"
        },
        {
          "$ref": "#/definitions/AttributeImpact"
        },
        {
          "$ref": "#/definitions/AttributeConditionMeter"
        }
      ]
    },
    "Asset": {
      "type": "object",
      "properties": {
        "_id": {
          "$ref": "#/definitions/DataforgedID",
          "pattern": "^[a-z_]+/assets/[a-z_]+/[a-z_]+$"
        },
        "attributes": {
          "patternProperties": {
            "^[a-z][a-z_+]*[a-z]$": {
              "$ref": "#/definitions/Attribute"
            }
          }
        },
        "name": {
          "$ref": "#/definitions/LocalizedLabel"
        },
        "abilities": {
          "type": "array",
          "additionalItems": false,
          "items": [
            {
              "$ref": "#/definitions/AssetAbility"
            },
            {
              "$ref": "#/definitions/AssetAbility"
            },
            {
              "$ref": "#/definitions/AssetAbility"
            }
          ]
        },
        "requirement": {
          "description": "A markdown string representing the requirement text that appears at the top of some asset cards.",
          "$ref": "#/definitions/LocalizedMarkdown"
        },
        "source": {
          "$ref": "#/definitions/Source"
        },
        "attachments": {
          "description": "Details on what attachments (other assets) are accepted by this asset.",
          "$comment": "#/definitions/AssetAttachment"
        },
        "tags": {
          "type": "array",
          "items": {
            "enum": [
              "animal_companion",
              "beast_companion",
              "biological_companion",
              "deed",
              "ironlander_companion",
              "mechanical_companion"
            ],
            "type": "string"
          }
        },
        "usage": {
          "$comment": "#/definitions/AssetUsage",
          "description": "Information on the asset's usage, such as whether its abilities are shared amongst the player characters."
        }
      },
      "required": [
        "abilities",
        "name",
        "_id"
      ],
      "not": {
        "required": [
          "inputs"
        ],
        "properties": {
          "inputs": {
            "type": "object"
          }
        }
      }
    },
    "CustomStat": {
      "type": "object",
      "required": [
        "label",
        "options"
      ],
      "properties": {
        "label": {
          "$ref": "#/definitions/LocalizedLabel"
        },
        "options": {
          "title": "CustomStatOptions",
          "type": "object",
          "patternProperties": {
            "^[a-z][a-z_+]*[a-z]$": {
              "title": "CustomStatOption",
              "type": "object",
              "required": [
                "label",
                "value"
              ],
              "properties": {
                "label": {
                  "$ref": "#/definitions/LocalizedLabel"
                },
                "value": {
                  "description": "The numeric value to be used as +stat when making an Action Roll.",
                  "type": "integer",
                  "minimum": 0
                }
              },
              "additionalProperties": false
            }
          }
        }
      },
      "additionalProperties": false
    },
    "ExtendAssetAbility": {
      "description": "Describes an upgrade to another asset ability. If a given property is omitted, assume it's the same as the original ability.",
      "allOf": [
        {
          "$ref": "#/definitions/AssetAbilityBase"
        },
        {
          "required": [
            "_ability"
          ],
          "properties": {
            "_ability": {
              "description": "The ID of the asset ability to be extended.",
              "$ref": "#/definitions/AssetAbilityID"
            }
          }
        }
      ]
    },
    "AlterMove": {
      "title": "AlterMove",
      "allOf": [
        {
          "$ref": "#/definitions/AlterMoveBase"
        },
        {
          "required": [
            "_moves"
          ],
          "properties": {
            "_moves": {
              "$ref": "#/definitions/AlterMoveBase/properties/_moves"
            }
          }
        }
      ]
    },
    "MoveID": {
      "anyOf": [
        {
          "$ref": "#/definitions/CoreMoveID"
        },
        {
          "$ref": "#/definitions/AssetMoveID"
        }
      ]
    },
    "AlterMoveBase": {
      "description": "Describes changes made to moves by asset abilities.",
      "type": "object",
      "properties": {
        "_moves": {
          "description": "The IDs of the affected moves. Use 'null' if it can apply to any move.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "$ref": "#/definitions/MoveID"
          },
          "default": null
        },
        "trigger": {
          "$ref": "#/definitions/MoveTrigger"
        }
      }
    },
    "AlterAsset": {
      "title": "AlterAsset",
      "description": "Alters another asset",
      "type": "object",
      "properties": {
        "assets": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/AssetID"
          }
        }
      }
    },
    "AlterPlayer": {
      "title": "AlterPlayer",
      "description": "Alters an attribute intrinsic to the player, such as a stat or condition meter.",
      "type": "object"
    },
    "MoveTriggerOptionAction": {
      "allOf": [
        {
          "$ref": "#/definitions/MoveTriggerOption"
        },
        {
          "properties": {
            "using": {
              "type": "array",
              "items": {
                "anyOf": [
                  {
                    "$ref": "#/definitions/PlayerStatID"
                  },
                  {
                    "$ref": "#/definitions/PlayerConditionMeterID"
                  },
                  {
                    "$ref": "#/definitions/ConditionMeterAlias"
                  },
                  {
                    "$ref": "#/definitions/AttributeID"
                  }
                ]
              }
            },
            "roll_type": {
              "const": "action_roll"
            }
          }
        }
      ]
    },
    "MoveTriggerOptionProgress": {
      "allOf": [
        {
          "$ref": "#/definitions/MoveTriggerOption"
        },
        {
          "properties": {
            "using": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ProgressTrackType"
              }
            },
            "roll_type": {
              "const": "progress_roll"
            }
          }
        }
      ]
    },
    "MoveOutcomeType": {
      "enum": [
        "miss",
        "weak_hit",
        "strong_hit"
      ]
    },
    "MoveOutcomeWithMatch": {
      "allOf": [
        {
          "$ref": "#/definitions/MoveOutcome"
        },
        {
          "properties": {
            "match": {
              "$ref": "#/definitions/MoveOutcome"
            }
          }
        }
      ]
    },
    "MoveOutcome": {
      "properties": {
        "text": {
          "$ref": "#/definitions/LocalizedMarkdown"
        }
      }
    },
    "MoveOutcomes": {
      "properties": {
        "miss": {
          "$ref": "#/definitions/MoveOutcomeWithMatch"
        },
        "weak_hit": {
          "$ref": "#/definitions/MoveOutcome"
        },
        "strong_hit": {
          "$ref": "#/definitions/MoveOutcomeWithMatch"
        }
      }
    },
    "MoveTriggerOption": {
      "properties": {
        "method": {
          "$ref": "#/definitions/SnakeCase",
          "title": "RollMethod",
          "type": "string",
          "description": "The method this move trigger uses to select which stat(s) or progress track(s) are rolled.\n\n`any`: When rolling with this move trigger option, the user picks which stat to use.\n\n`all`: When rolling with this move trigger option, *every* stat or progress track of the `using` key is rolled.\n\n`highest`: When rolling with this move trigger option, use the highest/best option from the `using` key.\n\n`lowest`: When rolling with this move trigger option, use the lowest/worst option from the `using` key.\n\n`inherit`: This move trigger option has no roll method of its own, and must inherit its roll from another move trigger option. If the parent's `Using` is defined, the inherited roll must use one of those stats/progress tracks.\n\n`strong_hit`: The move trigger option results in an automatic strong hit - no roll required.\n\n`weak_hit`: The move trigger option results in an automatic weak hit - no roll required.\n\n`miss`: The move trigger options results in an automatic miss - no roll required.",
          "default": "any",
          "enum": [
            "all",
            "any",
            "highest",
            "inherit",
            "lowest",
            "strong_hit",
            "weak_hit",
            "miss"
          ]
        },
        "text": {
          "$ref": "#/definitions/LocalizedMarkdown"
        },
        "using": {
          "type": "array",
          "description": "The stat(s) or progress track(s) that may be rolled with this move trigger option.",
          "items": {
            "type": "string"
          },
          "roll_type": {
            "title": "RollType",
            "$ref": "#/definitions/SnakeCase",
            "enum": [
              "action_roll",
              "progress_roll"
            ]
          }
        }
      }
    },
    "DataforgedID": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9_]*[a-z0-9](/[a-z][a-z_]*[a-z])+$",
      "description": "A unique string ID."
    },
    "MoveCategoryID": {
      "$ref": "#/definitions/DataforgedID",
      "pattern": "^[a-z0-9][a-z0-9_]*[a-z0-9]/moves/[a-z][a-z_]*[a-z]$"
    },
    "CoreMoveID": {
      "$ref": "#/definitions/DataforgedID",
      "pattern": "^[a-z0-9][a-z0-9_]*[a-z0-9]/moves(/[a-z][a-z_]*[a-z]){2}$"
    },
    "AssetMoveID": {
      "$ref": "#/definitions/CoreMoveID",
      "pattern": "^[a-z0-9][a-z0-9_]*[a-z0-9]/assets(/[a-z][a-z_]*[a-z]){2}/moves/[a-z][a-z_]*[a-z]$"
    },
    "AssetTypeID": {
      "$ref": "#/definitions/DataforgedID",
      "pattern": "^[a-z0-9][a-z0-9_]*[a-z0-9]/assets/[a-z][a-z_]*[a-z]$"
    },
    "AssetID": {
      "$ref": "#/definitions/DataforgedID",
      "pattern": "^[a-z0-9][a-z0-9_]*[a-z0-9]/assets(/[a-z][a-z_]*[a-z]){2}$"
    },
    "Localizable": {
      "description": "A localizable string of plain text.",
      "type": "string"
    },
    "LocalizedLabel": {
      "$ref": "#/definitions/Localizable",
      "description": "A localizable string of plain text used to provide a player-facing label for this element."
    },
    "LocalizedMarkdown": {
      "description": "A localizable string formatted in markdown. This usually represents a direct excerpt from the source material.",
      "type": "string"
    },
    "LocalizedTemplate": {
      "$comment": "TODO"
    },
    "Title": {
      "required": [
        "canonical"
      ],
      "additionalProperties": false,
      "properties": {
        "_id": {
          "$ref": "#/definitions/DataforgedID"
        },
        "canonical": {
          "description": "The title of this item, which here is defined as the associated header text *exactly* as it appears on the page (though it should be rendered in title case appropriate to the language, not all-caps).\n\nFor items that represent a single table column, this is the label that appears at the top of the column.\n\nUse this title if you want high fidelity to the book. For most interactive UX, it's recommended to use {@link Title.standard} instead.",
          "$ref": "#/definitions/LocalizedLabel"
        },
        "short": {
          "description": "The shortest title for this item that remains distinct amongst its siblings.\n\n Unless you're very pressed for space, most UX should use {@link Title.standard} instead.",
          "$ref": "#/definitions/LocalizedLabel"
        },
        "standard": {
          "description": "The recommended title for most implementations.\n\nThis is usually the same as the canonical title, but editorializes a bit by trimming out things like \"Oracle 15\" in some classic Ironsworn oracles (because *nobody* remembers it as \"Oracle 15\").",
          "$ref": "#/definitions/LocalizedLabel"
        }
      }
    },
    "Display": {
      "description": "Contains data relevant to rendering the item.",
      "properties": {
        "icon": {
          "description": "A URI pointing to a single SVG icon.",
          "type": "string",
          "format": "uri"
        },
        "images": {
          "description": "An array of URIs pointing to one or more WEBP images.",
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          }
        },
        "color": {
          "description": "A CSS color associated with this item, for use as e.g. an accent color when rendering it.",
          "type": "string",
          "format": "color"
        }
      }
    },
    "Summary": {
      "description": "A player-facing markdown summary of the item. Summary is shorter than {@link HasDescription| Description}, when they're both present.",
      "$ref": "#/definitions/LocalizedMarkdown"
    },
    "Description": {
      "$ref": "#/definitions/LocalizedMarkdown",
      "description": "A player-facing markdown description of the item, consisting of one or more paragraphs."
    },
    "Source": {
      "description": "Information on this item's source. For 'canonical' content, this is usually a book with a page number, but it might also be a link to a web site.",
      "type": "object",
      "required": [
        "authors",
        "license",
        "title"
      ],
      "additionalProperties": false,
      "examples": [
        {
          "title": "Ironsworn Assets Master Set",
          "authors": [
            "Shawn Tomkin"
          ],
          "license": "https://creativecommons.org/licenses/by/4.0",
          "date": "2023-01-15",
          "uri": "https://ironswornrpg.com"
        }
      ],
      "properties": {
        "title": {
          "description": "The title of the source.\n\nFor 'canonical' content, use one of the enumerated `SourceTitle` strings.\n\nFor 3rd-party content (including homebrew) that's been released as part of a titled document, use the title of that document (e.g. \"Steelforged\", \"Ironsmith\").\n\nIf the source has no particular title (for instance, it's a single custom element in a VTT implementation), use \"Custom\".",
          "type": "string",
          "examples": [
            "Ironsworn: Starforged Rulebook",
            "Ironsworn Rulebook",
            "Ironsworn: Delve",
            "Ironsworn: Starforged Assets",
            "Ironsworn Assets Master Set"
          ]
        },
        "authors": {
          "description": "The author(s) of this item. For 'canonical' content, this one's usually pretty obvious ðŸ˜‰ However, it's included so that homebrew content can use the same interface/schema.",
          "default": [
            "Shawn Tomkin"
          ],
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "page": {
          "description": "The page on which the item appears most prominently in the source material (if it's in a format that uses page numbers).",
          "type": "integer",
          "minimum": 1
        },
        "uri": {
          "description": "The URI where the source material is available.",
          "type": "string",
          "format": "uri",
          "examples": [
            "https://ironswornrpg.com"
          ]
        },
        "date": {
          "description": "The date when the source document's content was last updated.",
          "format": "date",
          "type": "string"
        },
        "license": {
          "description": "The URI pointing to the license which this item's *text* content falls under. If this is null, no license is specified -- use with caution.",
          "type": [
            "string",
            "null"
          ],
          "format": "uri",
          "default": "https://creativecommons.org/licenses/by-nc-sa/4.0",
          "examples": [
            "https://creativecommons.org/licenses/by-nc-sa/4.0",
            "https://creativecommons.org/licenses/by/4.0"
          ]
        }
      }
    },
    "QuestStarter": {
      "description": "A localizable markdown string describing the quest starter associated with this item.",
      "$ref": "#/definitions/LocalizedMarkdown"
    },
    "Tags": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/SnakeCase"
      }
    },
    "CategoryMetadata": {
      "type": "object",
      "required": [
        "_id",
        "title",
        "source"
      ],
      "properties": {
        "_id": {
          "$ref": "#/definitions/DataforgedID"
        },
        "title": {
          "$ref": "#/definitions/Title"
        },
        "source": {
          "$ref": "#/definitions/Source"
        },
        "display": {
          "$ref": "#/definitions/Display"
        },
        "summary": {
          "$ref": "#/definitions/Summary"
        },
        "description": {
          "$ref": "#/definitions/Description"
        },
        "tags": {
          "$ref": "#/definitions/Tags"
        }
      }
    },
    "Suggestions": {
      "type": "object",
      "description": "\"Non-canonical\" suggestions of related items. They might be convenient to present to the user, but in most implementations rolling them automatically is not recommended.",
      "$comment": "TODO"
    },
    "CyclopediaEntry": {
      "description": "Schema common to \"cyclopedia\" style pages, such as Regions (*Ironsworn* classic) and Encounters (*Ironsworn* classic and *Starforged*) ",
      "allOf": [
        {
          "$ref": "#/definitions/CategoryMetadata"
        },
        {
          "required": [
            "description"
          ],
          "additionalProperties": false,
          "properties": {
            "description": {
              "$ref": "#/definitions/Description"
            },
            "summary": {
              "$ref": "#/definitions/Summary"
            },
            "features": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/LocalizedMarkdown"
              }
            },
            "quest_starter": {
              "$ref": "#/definitions/QuestStarter"
            }
          }
        }
      ]
    },
    "Encounter": {
      "description": "Schema common to Encounter entries in *Ironsworn* and *Ironsworn: Starforged*.",
      "allOf": [
        {
          "$ref": "#/definitions/CyclopediaEntry"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "nature": {
              "type": "string"
            },
            "summary": {
              "$ref": "#/definitions/Summary",
              "examples": [
                "Insectoid horde"
              ]
            },
            "rank": {
              "$ref": "#/definitions/ChallengeRank"
            },
            "drives": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/LocalizedMarkdown"
              }
            },
            "tactics": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/LocalizedMarkdown"
              }
            }
          }
        }
      ]
    },
    "Oracle": {
      "description": "Interface with elements common to various Oracle-related interfaces and classes.\n\nIf you're trying to crawl the tree for a specific ID, I'd recommend using some flavour of JSONpath (I like `jsonpath-plus`) - it's purpose-made for this sort of nested data structure.\n\nBut if for some reason you can't, you can use this interface to type both {@link OracleTable} and {@link OracleSet} as you recurse the oracle hierarchy. Objects with `sets` and `tables` are \"branches\", and objects with `table` are \"leaves\".",
      "additionalProperties": false,
      "properties": {
        "title": {
          "$ref": "#/definitions/Title"
        },
        "summary": {
          "$ref": "#/definitions/Summary"
        },
        "description": {
          "$ref": "#/definitions/Description"
        },
        "display": {
          "$ref": "#/definitions/Display"
        },
        "ancestors": {
          "description": "An array containing the ID of every {@link OracleSet} ancestor of this item. The array is sorted from the most recent ancestor (e.g. one level up) to the most distant.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/DataforgedID"
          }
        }
      }
    },
    "OracleSet": {
      "title": "OracleSet",
      "type": "object",
      "description": "Represents an oracle set: a grouping that can contain both {@link OracleTable}s and other instances of {@link OracleSet}, but doesn't have its own `Table` key.\n\nSee {@link Oracle} if you need to type both {@link OracleTable} and {@link OracleSet} to crawl the oracle hierarchy in search of a specific `_id`.",
      "additionalProperties": false,
      "properties": {
        "requires": {
          "$comment": "TODO"
        },
        "usage": {
          "$ref": "#/definitions/Source"
        },
        "sets": {
          "additionalProperties": false,
          "patternProperties": {
            "^[a-z][a-z_+]*[a-z]$": {
              "$ref": "#/definitions/OracleSet"
            }
          }
        },
        "tables": {
          "additionalProperties": false,
          "patternProperties": {
            "^[a-z][a-z_+]*[a-z]$": {
              "$ref": "#/definitions/OracleTable"
            }
          }
        },
        "content": {
          "$comment": "TODO"
        },
        "sample_names": {
          "description": "A list of sample names for this category. Only used by Planets.",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "OracleTable": {
      "type": "object",
      "required": [
        "title",
        "table"
      ],
      "additionalProperties": false,
      "properties": {
        "content": {
          "title": "OracleContent",
          "type": "object",
          "description": "Metadata that describes an oracle's semantic or lexical content.",
          "additionalProperties": false,
          "properties": {
            "part_of_speech": {
              "description": "The part of speech of this oracle.",
              "type": "array",
              "items": {
                "examples": [
                  "adjective",
                  "common noun",
                  "compound noun",
                  "fragment",
                  "name",
                  "noun",
                  "plural",
                  "possessive case",
                  "proper noun",
                  "proper noun fragment",
                  "sentences",
                  "verb"
                ],
                "type": "string"
              }
            },
            "tags": {
              "description": "Any arbitrary string tags associated with this oracle.",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "title": {
          "$ref": "#/definitions/Title"
        },
        "usage": {
          "title": "OracleUsage",
          "type": "object"
        },
        "requires": {
          "title": "OracleRequirements",
          "type": "object"
        },
        "display": {
          "title": "OracleTableDisplay",
          "type": "object",
          "allOf": [
            {
              "$ref": "#/definitions/Display"
            },
            {
              "additionalProperties": false,
              "properties": {
                "columns": {
                  "type": "object",
                  "additionalProperties": {
                    "anyOf": [
                      {
                        "$comment": "#/definitions/TableColumnRoll"
                      },
                      {
                        "$comment": "#/definitions/TableColumnText"
                      }
                    ]
                  }
                },
                "column_of": {
                  "description": "If this oracle's `Table` should be rendered as a column of another table, it's indicated here.\n\nIf `undefined`, this table is rendered as a standalone table.\n\nIf this is set (and the rendering such 'embedded' columns is desired), then `Display.Table` may be safely ignored.",
                  "type": "string"
                },
                "embed_in": {
                  "description": "This table is displayed as embedded in a row of another table.",
                  "type": "string"
                },
                "source": {
                  "$ref": "#/definitions/Source"
                }
              }
            }
          ]
        },
        "table": {
          "$ref": "#/definitions/OracleTableRows"
        },
        "on_a_match": {
          "title": "OracleMatchBehaviour",
          "type": "object",
          "properties": {
            "_id": {
              "$ref": "#/definitions/DataforgedID"
            },
            "text": {
              "$ref": "#/definitions/LocalizedMarkdown"
            }
          },
          "additionalProperties": false,
          "required": [
            "_id",
            "text"
          ]
        },
        "source": {
          "$ref": "#/definitions/Source"
        }
      }
    },
    "OracleTableRows": {
      "additionalProperties": false,
      "patternProperties": {
        "^[0-9]+(-[0-9]+)?$": {
          "$ref": "#/definitions/OracleTableRow"
        }
      }
    },
    "OracleTableRow": {
      "required": [
        "result",
        "floor",
        "ceiling",
        "_id"
      ],
      "additionalProperties": false,
      "properties": {
        "_id": {
          "$ref": "#/definitions/DataforgedID"
        },
        "floor": {
          "type": [
            "integer",
            "null"
          ],
          "minimum": 1,
          "maximum": 100
        },
        "ceiling": {
          "type": [
            "integer",
            "null"
          ],
          "minimum": 1,
          "maximum": 100
        },
        "result": {
          "description": "The primary result text for the row, annotated in Markdown.\nIn the book, this is frequently the only column aside from the roll column. Otherwise, it is the first column.\nSome tables label this column as something other than Result; see the parent (or grandparent) `Oracle.display` for more information.",
          "$ref": "#/definitions/LocalizedMarkdown"
        },
        "summary": {
          "description": "A secondary markdown string that must be presented to the user for the implementation to be complete, but may benefit from progressive disclosure (such as a collapsible element, popover/tooltip, etc).\n\nGenerally, `OracleTableRow.summary` is longer than `OracleTableRow.result`.\n\nSome tables label this column as something other than `OracleTableRow.result`; see the parent (or grandparent) `Oracle.Display.Table` for more information.\n\n`null` is used in cases where an 'empty' `OracleTableRow.summary` exists (example: Starship Type, p. 326). In the book, these table cells are rendered with the text `--` (and this is the recommended placeholder for tabular display). For display as a single result (e.g. VTT roll output), however, `null` values can be safely omitted.",
          "oneOf": [
            {
              "$ref": "#/definitions/LocalizedMarkdown"
            },
            {
              "type": "null"
            }
          ]
        },
        "display": {
          "$ref": "#/definitions/Display"
        }
      }
    },
    "InputPosition": {
      "title": "InputPosition",
      "enum": [
        "card-top",
        "card-back",
        "card-bottom",
        "ability-1-right",
        "ability-2-right",
        "ability-3-right",
        "ability-1-bottom",
        "ability-2-bottom",
        "ability-3-bottom"
      ],
      "type": "string"
    },
    "Move": {
      "type": "object",
      "properties": {
        "name": {
          "$ref": "#/definitions/LocalizedLabel"
        },
        "trigger": {
          "$ref": "#/definitions/MoveTrigger"
        },
        "attributes": {
          "type": "object",
          "patternProperties": {
            "^[a-z][a-z_+]*[a-z]$": {
              "$ref": "#/definitions/CustomStat"
            }
          }
        },
        "outcomes": {
          "$ref": "#/definitions/MoveOutcomes"
        },
        "text": {
          "$ref": "#/definitions/LocalizedMarkdown"
        },
        "suggestions": {
          "$ref": "#/definitions/Suggestions"
        },
        "asset": {
          "description": "The ID of the parent Asset of the move, if any.",
          "$ref": "#/definitions/AssetID"
        },
        "progress_move": {
          "description": "Whether or not the move is a Progress Move. Progress moves roll two challenge dice against a progress score.",
          "type": "boolean"
        },
        "variant_of": {
          "description": "The ID of the move that this move is a variant of, if any.",
          "type": "string"
        },
        "oracles": {
          "description": "The IDs of any oracles directly referenced by the move, or vice versa.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/DataforgedID"
          }
        },
        "optional": {
          "description": "Whether or not the source material presents this rules item as optional.",
          "default": false,
          "type": "boolean"
        },
        "display": {
          "$ref": "#/definitions/Display"
        },
        "tags": {
          "description": "Arbitrary strings tags that describe optional metadata that doesn't fit in other properties.",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "category": {
          "description": "The ID of the move's category.",
          "type": "string"
        },
        "source": {
          "$ref": "#/definitions/Source"
        }
      },
      "additionalProperties": false,
      "required": [
        "text",
        "name",
        "trigger"
      ]
    },
    "SettingTruthOption": {
      "required": [
        "quest_starter"
      ],
      "additionalProperties": false,
      "properties": {
        "quest_starter": {
          "$ref": "#/definitions/QuestStarter"
        }
      }
    },
    "SettingTruth": {
      "$ref": "#/definitions/CategoryMetadata"
    }
  },
  "additionalProperties": false,
  "properties": {
    "asset_types": {
      "title": "AssetTypes",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "oneOf": [
            {
              "title": "AssetTypeExtension",
              "description": "Extends a canonical asset type with additional assets.",
              "type": "object",
              "additionalProperties": false,
              "required": [
                "_extends",
                "assets"
              ],
              "properties": {
                "_extends": {
                  "type": "string",
                  "pattern": "^(starforged|ironsworn)/assets/[a-z][a-z_+]*[a-z]$",
                  "examples": [
                    "ironsworn/assets/companion",
                    "ironsworn/assets/path",
                    "ironsworn/assets/combat_talent",
                    "ironsworn/assets/ritual",
                    "starforged/assets/command_vehicle",
                    "starforged/assets/module",
                    "starforged/assets/support_vehicle",
                    "starforged/assets/path",
                    "starforged/assets/companion",
                    "starforged/assets/deed"
                  ]
                },
                "assets": {
                  "type": "object",
                  "patternProperties": {
                    "^[a-z][a-z_+]*[a-z]$": {
                      "$ref": "#/definitions/Asset"
                    }
                  }
                }
              }
            },
            {
              "title": "AssetType",
              "type": "object",
              "allOf": [
                {
                  "$ref": "#/definitions/CategoryMetadata"
                },
                {
                  "required": [
                    "assets",
                    "description",
                    "title"
                  ],
                  "properties": {
                    "assets": {
                      "type": "object",
                      "additionalProperties": false,
                      "patternProperties": {
                        "^[a-z][a-z_+]*[a-z]$": {
                          "$ref": "#/definitions/Asset"
                        }
                      }
                    },
                    "description": {
                      "$ref": "#/definitions/Description"
                    },
                    "display": {
                      "$ref": "#/definitions/Display"
                    },
                    "source": {
                      "$ref": "#/definitions/Source"
                    },
                    "title": {
                      "$ref": "#/definitions/Title"
                    }
                  }
                }
              ]
            }
          ]
        }
      }
    },
    "oracle_sets": {
      "title": "OracleSets",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "$ref": "#/definitions/OracleSet"
        }
      }
    },
    "move_categories": {
      "title": "MoveCategories",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "MoveCategory",
          "allOf": [
            {
              "properties": {
                "moves": {
                  "patternProperties": {
                    "^[a-z][a-z_+]*[a-z]$": {
                      "$ref": "#/definitions/Move"
                    }
                  }
                }
              }
            }
          ]
        }
      }
    },
    "encounter_natures": {
      "title": "EncountersClassic",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "EncounterNatureClassic",
          "additionalProperties": false,
          "properties": {
            "encounters": {
              "additionalProperties": false,
              "patternProperties": {
                "^[a-z][a-z_+]*[a-z]$": {
                  "title": "EncounterClassic",
                  "allOf": [
                    {
                      "$ref": "#/definitions/Encounter"
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "nature": {
                          "title": "EncounterNatureTypeClassic",
                          "type": "string",
                          "examples": [
                            "Ironlander",
                            "firstborn",
                            "animal",
                            "beast",
                            "horror",
                            "anomaly"
                          ]
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "encounters": {
      "title": "EncountersStarforged",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "EncounterStarforged",
          "allOf": [
            {
              "$ref": "#/definitions/Encounter"
            },
            {
              "required": [
                "summary",
                "nature"
              ],
              "additionalProperties": false,
              "properties": {
                "summary": {
                  "$ref": "#/definitions/Summary"
                },
                "nature": {
                  "title": "EncounterNatureTypeStarforged",
                  "type": "string",
                  "examples": [
                    "creature",
                    "horror",
                    "human",
                    "machine",
                    "monster"
                  ]
                },
                "variants": {
                  "additionalProperties": false,
                  "patternProperties": {
                    "^[a-z][a-z_+]*[a-z]$": {
                      "$ref": "#/definitions/Encounter"
                    }
                  }
                }
              }
            }
          ]
        }
      }
    },
    "ironlands_regions": {
      "title": "IronlandsRegions",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "IronlandsRegion",
          "allOf": [
            {
              "$ref": "#/definitions/CyclopediaEntry"
            },
            {
              "required": [
                "description",
                "features",
                "quest_starter",
                "summary",
                "title"
              ]
            }
          ]
        }
      }
    },
    "world_truths": {
      "title": "SettingTruthsClassic",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "SettingTruthClassic",
          "allOf": [
            {
              "$ref": "#/definitions/SettingTruth"
            }
          ]
        }
      }
    },
    "setting_truths": {
      "title": "SettingTruthsStarforged",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "SettingTruthStarforged",
          "allOf": [
            {
              "$ref": "#/definitions/SettingTruth"
            }
          ]
        }
      }
    },
    "rarities": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "Rarity"
        }
      }
    },
    "delve_site_domains": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "DelveSiteDomain"
        }
      }
    },
    "delve_site_themes": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "DelveSiteTheme"
        }
      }
    },
    "delve_sites": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^[a-z][a-z_+]*[a-z]$": {
          "title": "DelveSite"
        }
      }
    }
  }
}